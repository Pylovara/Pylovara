#!/bin/bash
clear
set -euo pipefail
IFS=$'\n\t'
sleep 2
echo "#---------------------TimeForReadme----------------------#"
sleep 2
echo "#      https://github.com/Pylovara/Hyprland-Module/      #"
sleep 0.3
echo "#      â”â”“  â”“â”  â”“   â”â”“  â”“â”  â”â”“  â”³â”“  â”â”“                    #"
sleep 0.1
echo "#      â”ƒâ”ƒ  â”—â”«  â”ƒ   â”ƒâ”ƒ  â”ƒâ”ƒ  â”£â”«  â”£â”«  â”£â”«                    #"
sleep 0.1
echo "#      â”£â”›  â”—â”›  â”—â”›  â”—â”›  â”—â”›  â”›â”—  â”›â”—  â”›â”—                    #"
sleep 2
echo "#          â”â”“â€¢â”“  â”³â”³â”“                                     #"
sleep 0.1
echo "#          â”£ â”“â”ƒâ”â”“â”ƒâ”ƒâ”ƒâ”â”“â”â”“â”â”“â”â”“â”â”“â”â”“   p & pylo              #"
sleep 0.1
echo "#          â”» â”—â”—â”— â”› â”—â”—â”»â”›â”—â”—â”»â”—â”«â”— â”›     SHELL                #"
sleep 0.1
echo "#                          â”›                             #"
sleep 2
echo "#        â”³â”“â”â”“â”â”³â”“â”â”“  â”â”“â”â”“â”â”“â”â”   â”  â•»                      #"
sleep 0.1
echo "#        â”£â”«â”£  â”ƒ â”£â”«  â”â”›â”ƒâ”«â”â”›â”—â”“  â”â”«â”â”â”ƒâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”    #"
sleep 0.1
echo "#        â”»â”›â”—â”› â”» â”›â”—  â”—â”â”—â”›â”—â”â”—â”›   â”—  â•¹Pylovara-FileManager  #"
sleep 0.1
echo "#--------------------------------------------------------#"
sleep 6
echo "#      Used in the Shell for commands options infos      #"
sleep 2
echo "#              pylo         |           p                #"
sleep 0.2
echo "#---------------------------|----------------------------#"
sleep 0.1
echo "#           pylooptions     |        poptions            #"
sleep 0.1
echo "#--------------------------------------------------------#"
sleep 6
echo "#   >>>>>>>>>   Used prompt in the Shell   <<<<<<<<<<<<  #"
sleep 2
echo "#   SHELL |                Beispiel                      #"
sleep 0.2
echo "#---------|----------------------------------------------#"
sleep 0.2
echo "#    p    | pdownloads pmusik phypr ptwitch puserscripts #"
sleep 0.2
echo "#    p    | phyprland  pdokumente ptorbrowser ppictures  #"
sleep 0.2
echo "#--------------------------------------------------------#"
sleep 2
echo "#    pylovara | searcht all*.wiki-notes ON               #"
sleep 2
echo "#    pylovara YouSearch(.wiki-notes)                     #"
sleep 2
echo "#---------|----------------------------------------------#"
sleep 6
echo "#   SHELL | pylo > Directory > Data > SHELL > (&& SHELL) #"
sleep 2
echo "#---------|----------------------------------------------#"
sleep 2
echo "#   pylo  | pylo Downloads/- Readme.md cat               #"
sleep 0.1
echo "#   pylo  | pylo Musik/- data.mp3 vlc                    #"
sleep 0.1
echo "#   pylo  | pylo Video/- MyVideo.mp4 mpv                 #"
sleep 0.1
echo "#   pylo  | pylo Downloads/- Scripts.sh chmod +x         #"
sleep 0.1
echo "#   pylo  | pylo Downloads/- WatEver.zip cp ~/home       #"
sleep 0.1
echo "#--------------------------------------------------------#"
sleep 10
echo "#         Pylovara is from User for User Maket           #"
sleep 3
echo "#    Used Easy - Speed Navigations - Better Control      #"
sleep 3
echo "#     Do yourself a favor and use a proper shell...      #"
sleep 0.5
echo "#       My recommendation: Kitty or Alacritty.           #"
echo "#        sudo pacman -S kitty other Alacritty            #"
echo "#--------------Sudo Install Prozess Ready ---------------#"
echo "#--------------Joint to better System ;-) ---------------#"
sleep 8

echo "# ##############################################################"
echo "# INSTALL-SCRIPT FOR ALL .NODES IN Pylovara-FileManager-System"
echo "# Zweck : Macht .p-nodes, .pylo-nodes & .wiki-nodes systemweit ausfÃ¼hrbar"
echo "# Motto : from User, for User â€“ Admin mit Ehre und Struktur!"
echo "# ##############################################################"
sleep 6
echo "Ein gutes System erkennt man nicht an seinem Umfang, sondern an seinem Charakter."
echo "        â€žFunktioniertâ€œ ist das eine, â€ždurchdacht wartbarâ€œ das andere.         "
sleep 6
# Root des Systems (aktuell ausfÃ¼hren aus Hauptverzeichnis oder direkt anpassen)
BASE_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"

# Zieltypen
declare -a node_types=("p-nodes" "pylo-nodes" "wiki-nodes" "p-notes" "pylo-notes" "wiki-notes" "nano-nodes" "nano-notes" "micro-control-nodes")

# Durchsuche rekursiv das System
for node_type in "${node_types[@]}"; do
    echo "ðŸ” Suche nach *.$node_type Dateien..."
    find "$BASE_DIR" -type f -name "*.${node_type}" | while read -r node_file; do
        echo "ðŸ›  Setze ausfÃ¼hrbar: $node_file"
        chmod +x "$node_file"
    done
done

INSTALL_DIR="/Pylovara-FileManager-System"
REPO_DIR="$(pwd)"

echo "[*] Starte Pylovara-Installation..."
[ "$(id -u)" -ne 0 ] && echo "[!] Fehler: Root-Rechte benÃ¶tigt (su oder sudo)." && exit 1

# Backup bei bestehender Installation
if [ -d "$INSTALL_DIR" ]; then
    echo "[!] Bestehendes Pylovara-System gefunden. Backup wird erstellt..."
    mv "$INSTALL_DIR" "${INSTALL_DIR}_backup_$(date +%s)"
fi

# Kopieren ins Root-System
echo "[*] Installiere nach $INSTALL_DIR..."
cp -r "$REPO_DIR/Pylovara-FileManager-System" "$INSTALL_DIR"

# .bashrc / .zshrc Anbindung (optional)
read -p "[?] .bashrc/.zshrc anpassen und Pylovara aktivieren? [Y/n] " CONFIRM
CONFIRM=${CONFIRM,,}  # to lowercase
if [[ "$CONFIRM" != "n" ]]; then
    SRC_LINE="source $INSTALL_DIR/Pylovara-DirectoryManager/SystemControl.pv-conf"
    for RC in "/root/.bashrc" "/root/.zshrc"; do
        if [ -f "$RC" ]; then
            grep -qxF "$SRC_LINE" "$RC" || echo "$SRC_LINE" >> "$RC"
            echo "[*] $RC angepasst."
        fi
    done
else
    echo "[*] .bashrc/.zshrc wurden nicht geÃ¤ndert."
fi

echo ""
echo "âœ… Alle relevanten Knoten wurden mit AusfÃ¼hrungsrechten versehen."
echo "------------------------------------------------------------"
echo "ðŸ’¡ Tipp: FÃ¼ge 'pylovaracontrol.p-nodes' zu deinem Shell-Init hinzu fÃ¼r Schnellstart."
echo ""
echo "ðŸŽ‰ Pylovara ist jetzt bereit. Modular. Offen. Shellbasiert. Ehrlich."
echo " Â» from User, for User Â«"
echo ""
